# Migration `20200425191027-init`

This migration has been generated by joondong2 at 4/25/2020, 7:10:27 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `instagureng`.`User` (
    `avatar` varchar(191) NOT NULL DEFAULT 'https://3.bp.blogspot.com/-qtEejOg1NHA/Xobmg2y_QeI/AAAAAAAAIVE/UFKPvpeHjKUqCEFOX8lT4MsKz-PwpEGJgCLcBGAsYHQ/s1600/default_user.png' ,
    `bio` varchar(191) NOT NULL DEFAULT '' ,
    `createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
    `email` varchar(191) NOT NULL  ,
    `firstName` varchar(191) NOT NULL  ,
    `id` int NOT NULL  AUTO_INCREMENT,
    `lastName` varchar(191) NOT NULL  ,
    `updatedAt` datetime(3) NOT NULL  ,
    `userName` varchar(191) NOT NULL  ,
    PRIMARY KEY (`id`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `instagureng`.`Post` (
    `caption` varchar(191) NOT NULL  ,
    `createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
    `id` int NOT NULL  AUTO_INCREMENT,
    `location` varchar(191) NOT NULL  ,
    `updatedAt` datetime(3) NOT NULL  ,
    `userId` int NOT NULL ,
    PRIMARY KEY (`id`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `instagureng`.`Like` (
    `createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
    `id` int NOT NULL  AUTO_INCREMENT,
    `postId` int NOT NULL ,
    `updatedAt` datetime(3) NOT NULL  ,
    `userId` int NOT NULL ,
    PRIMARY KEY (`id`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `instagureng`.`Comment` (
    `createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
    `id` int NOT NULL  AUTO_INCREMENT,
    `postId` int NOT NULL ,
    `text` varchar(191) NOT NULL  ,
    `updatedAt` datetime(3) NOT NULL  ,
    `userId` int NOT NULL ,
    PRIMARY KEY (`id`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `instagureng`.`File` (
    `createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
    `id` int NOT NULL  AUTO_INCREMENT,
    `postId` int NOT NULL ,
    `updatedAt` datetime(3) NOT NULL  ,
    `url` varchar(191) NOT NULL  ,
    PRIMARY KEY (`id`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `instagureng`.`_UserFollows` (
    `A` int NOT NULL ,
    `B` int NOT NULL 
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE UNIQUE INDEX `User.userName` ON `instagureng`.`User`(`userName`)

CREATE UNIQUE INDEX `User.email` ON `instagureng`.`User`(`email`)

CREATE UNIQUE INDEX `_UserFollows_AB_unique` ON `instagureng`.`_UserFollows`(`A`,`B`)

CREATE  INDEX `_UserFollows_B_index` ON `instagureng`.`_UserFollows`(`B`)

ALTER TABLE `instagureng`.`Post` ADD FOREIGN KEY (`userId`) REFERENCES `instagureng`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagureng`.`Like` ADD FOREIGN KEY (`userId`) REFERENCES `instagureng`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagureng`.`Like` ADD FOREIGN KEY (`postId`) REFERENCES `instagureng`.`Post`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagureng`.`Comment` ADD FOREIGN KEY (`userId`) REFERENCES `instagureng`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagureng`.`Comment` ADD FOREIGN KEY (`postId`) REFERENCES `instagureng`.`Post`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagureng`.`File` ADD FOREIGN KEY (`postId`) REFERENCES `instagureng`.`Post`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagureng`.`_UserFollows` ADD FOREIGN KEY (`A`) REFERENCES `instagureng`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagureng`.`_UserFollows` ADD FOREIGN KEY (`B`) REFERENCES `instagureng`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200425191027-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,72 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "mysql"
+  url      = env("DATABASE_URL")
+}
+
+generator client {
+  provider = "prisma-client-js"
+  binaryTargets = ["native"]
+}
+
+model User {
+  id          Int       @default(autoincrement()) @id
+  userName    String    @unique
+  avatar      String    @default(value: "https://3.bp.blogspot.com/-qtEejOg1NHA/Xobmg2y_QeI/AAAAAAAAIVE/UFKPvpeHjKUqCEFOX8lT4MsKz-PwpEGJgCLcBGAsYHQ/s1600/default_user.png")
+  email       String    @unique
+  firstName   String
+  lastName    String
+  bio         String    @default(value: "")
+  posts       Post[]
+  followers   User[]    @relation("UserFollows", references: [id])
+  following   User[]    @relation("UserFollows", references: [id])
+  likes       Like[]
+  comments    Comment[]
+  createdAt   DateTime  @default(now())
+  updatedAt   DateTime  @updatedAt
+}
+
+model Post {
+  id          Int     @default(autoincrement()) @id
+  user        User    @relation(fields: [userId], references: [id])
+  userId      Int
+  location    String
+  caption     String
+  files       File[]
+  comments    Comment[]
+  likes       Like[]
+  createdAt   DateTime  @default(now())
+  updatedAt   DateTime  @updatedAt
+}
+
+model Like {
+  id          Int       @default(autoincrement()) @id
+  user    User  @relation(fields: [userId], references: [id])
+  userId  Int
+  post    Post  @relation(fields: [postId], references: [id])
+  postId  Int
+  createdAt   DateTime  @default(now())
+  updatedAt   DateTime  @updatedAt
+}
+
+model Comment {
+  id          Int       @default(autoincrement()) @id
+  text    String
+  user    User      @relation(fields: [userId], references: [id])
+  userId  Int
+  post    Post      @relation(fields: [postId], references: [id])
+  postId  Int
+  createdAt   DateTime  @default(now())
+  updatedAt   DateTime  @updatedAt
+}
+
+model File {
+  id          Int       @default(autoincrement()) @id
+  url     String
+  post    Post      @relation(fields: [postId], references: [id])
+  postId  Int
+  createdAt   DateTime  @default(now())
+  updatedAt   DateTime  @updatedAt
+}
```


